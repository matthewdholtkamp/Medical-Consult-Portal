<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Medical Specialist Consult Portal</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="js/theme.js"></script>

    <!-- Marked.js for Markdown Parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Condensed:wght@700&display=swap"
        rel="stylesheet">
    <!-- Google Icons -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Scrollbar styling */
        .custom-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .custom-scroll::-webkit-scrollbar-track {
            background: transparent;
        }

        .custom-scroll::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 10px;
        }

        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }

        /* Dr. Holtkamp "Thinking Brain" Animation */
        @keyframes brain-think {
            0% {
                color: #60a5fa;
                /* Blue */
                transform: scale(1);
                filter: drop-shadow(0 0 2px rgba(96, 165, 250, 0.2));
            }

            33% {
                color: #a78bfa;
                /* Purple */
                transform: scale(1.15);
                filter: drop-shadow(0 0 8px rgba(167, 139, 250, 0.4));
            }

            66% {
                color: #2dd4bf;
                /* Teal */
                transform: scale(1);
                filter: drop-shadow(0 0 2px rgba(45, 212, 191, 0.2));
            }

            100% {
                color: #60a5fa;
                /* Blue */
                transform: scale(1);
                filter: drop-shadow(0 0 2px rgba(96, 165, 250, 0.2));
            }
        }

        .animate-brain {
            animation: brain-think 3s ease-in-out infinite;
        }

        /* Card Styles */
        .card {
            transition: transform 0.25s ease, box-shadow 0.25s ease;
        }

        .card:hover {
            transform: translateY(-4px) scale(1.01);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .card-blocked {
            opacity: 0.5;
            filter: grayscale(0.8);
            pointer-events: none;
            user-select: none;
            background: #0f172a;
            border: 1px solid #1e293b;
        }

        /* Glass effect for search bar */
        .glass-search {
            background: rgba(30, 41, 59, 0.4);
            backdrop-filter: blur(8px);
        }

        /* Faded Background Image Style */
        /* Animated "Deep Space Aurora" Background */
        .background-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            background-color: #0b0f19;
            /* gemini-900 base */
            overflow: hidden;
        }

        /* Orb 1: Blue/Indigo Flow */
        .background-overlay::before {
            content: '';
            position: absolute;
            top: -20%;
            left: -10%;
            width: 80%;
            height: 80%;
            background: radial-gradient(circle at center, rgba(59, 130, 246, 0.15), transparent 60%);
            filter: blur(80px);
            animation: orb-float-1 15s ease-in-out infinite alternate;
            opacity: 0.7;
        }

        /* Orb 2: Purple/Violet Flow */
        .background-overlay::after {
            content: '';
            position: absolute;
            bottom: -20%;
            right: -10%;
            width: 70%;
            height: 70%;
            background: radial-gradient(circle at center, rgba(139, 92, 246, 0.15), transparent 60%);
            filter: blur(80px);
            animation: orb-float-2 18s ease-in-out infinite alternate;
            opacity: 0.6;
        }

        /* Secondary Layer for Depth (Teal hint) */
        .background-overlay .depth-layer {
            position: absolute;
            top: 40%;
            left: 40%;
            width: 60%;
            height: 60%;
            background: radial-gradient(circle at center, rgba(20, 184, 166, 0.1), transparent 50%);
            filter: blur(90px);
            animation: orb-float-3 20s ease-in-out infinite alternate;
        }

        @keyframes orb-float-1 {
            0% {
                transform: translate(0, 0) scale(1);
            }

            50% {
                transform: translate(10%, 5%) scale(1.1);
            }

            100% {
                transform: translate(-5%, 10%) scale(0.95);
            }
        }

        @keyframes orb-float-2 {
            0% {
                transform: translate(0, 0) scale(1);
            }

            50% {
                transform: translate(-10%, -5%) scale(1.1);
            }

            100% {
                transform: translate(5%, -10%) scale(0.9);
            }
        }

        @keyframes orb-float-3 {
            0% {
                transform: translate(0, 0) rotate(0deg);
                opacity: 0.3;
            }

            50% {
                opacity: 0.6;
            }

            100% {
                transform: translate(-15%, 5%) rotate(10deg);
                opacity: 0.3;
            }
        }

        /* Simple Prose for Markdown Content */
        .prose-content ul {
            list-style-type: disc;
            padding-left: 1.5rem;
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .prose-content ol {
            list-style-type: decimal;
            padding-left: 1.5rem;
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .prose-content p {
            margin-bottom: 0.75rem;
            line-height: 1.6;
        }

        .prose-content strong {
            color: #e2e8f0;
            font-weight: 700;
        }

        .prose-content h1,
        .prose-content h2,
        .prose-content h3 {
            color: #f8fafc;
            font-weight: 700;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }

        .prose-content li {
            margin-bottom: 0.25rem;
        }

        /* Fix for superscripts in prose */
        .prose-content sup {
            color: #3b82f6;
            font-weight: 600;
            font-size: 0.75em;
            margin-left: 1px;
        }
    </style>
</head>

<body
    class="bg-gemini-900 text-gray-200 h-screen overflow-hidden flex selection:bg-sky-500 selection:text-white relative">

    <!-- Background Image Container -->
    <!-- Background Image Container -->
    <div class="background-overlay">
        <div class="depth-layer"></div>
    </div>

    <!-- =================================================================== -->
    <!-- DISCLAIMER MODAL (PREMIUM REDESIGN) -->
    <!-- =================================================================== -->
    <div id="disclaimerModal"
        class="fixed inset-0 z-[100] flex items-center justify-center backdrop-blur-3xl bg-gemini-900/90 transition-all duration-700 hidden">

        <!-- Decorative background glow -->
        <div
            class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-blue-600/20 rounded-full blur-[100px] pointer-events-none">
        </div>

        <div class="w-full max-w-lg relative z-10 px-4">
            <div
                class="bg-gemini-800/80 backdrop-blur-xl border border-white/10 rounded-3xl shadow-2xl shadow-black/50 overflow-hidden ring-1 ring-white/5">

                <!-- Header -->
                <div class="p-8 pb-6 text-center border-b border-white/5 bg-gradient-to-b from-white/5 to-transparent">
                    <div
                        class="w-16 h-16 bg-blue-500 rounded-2xl mx-auto mb-6 flex items-center justify-center shadow-lg shadow-blue-500/30">
                        <span class="material-symbols-outlined text-white text-3xl">medical_services</span>
                    </div>
                    <h2 class="text-3xl font-bold text-white mb-2 tracking-tight">Welcome to MedCon</h2>
                    <p class="text-slate-400 text-sm">AI-Augmented Clinical Decision Support</p>
                </div>

                <!-- Content -->
                <div class="p-8 space-y-6">
                    <div class="space-y-4">
                        <p class="text-slate-300 text-sm leading-relaxed text-center">
                            This platform uses advanced AI to generate consult drafts. It is a tool for
                            <strong class="text-white">medical professionals</strong>, not a replacement for clinical
                            judgment.
                        </p>

                        <div class="bg-red-500/10 border border-red-500/20 rounded-xl p-4 flex gap-3 items-start">
                            <span class="material-symbols-outlined text-red-400 shrink-0 text-lg mt-0.5">warning</span>
                            <p class="text-xs text-red-200 leading-relaxed font-medium">
                                STRICTLY NON-HIPAA COMPLIANT. <br>
                                <span class="text-red-300 font-normal">Do not enter Patient Health Information (PHI) or
                                    PII under any circumstances.</span>
                            </p>
                        </div>
                    </div>

                    <!-- Action Area -->
                    <div class="space-y-4 pt-2">
                        <!-- Toggle Row -->
                        <div id="ackRow"
                            class="group flex items-center gap-4 p-4 rounded-xl border border-slate-700 bg-gemini-800 hover:bg-slate-700/50 cursor-pointer transition-all duration-300">
                            <div class="relative flex items-center">
                                <input type="checkbox" id="ackCheckbox"
                                    class="peer h-6 w-6 cursor-pointer opacity-0 absolute inset-0 z-20">
                                <div
                                    class="w-6 h-6 rounded-full border-2 border-slate-500 peer-checked:bg-blue-500 peer-checked:border-blue-500 flex items-center justify-center transition-all bg-transparent z-10 pointer-events-none">
                                    <span
                                        class="material-symbols-outlined text-white text-[16px] opacity-0 peer-checked:opacity-100 transition-opacity">check</span>
                                </div>
                            </div>
                            <div class="flex-1">
                                <p class="text-white font-medium text-sm">I acknowledge the safety warning</p>
                                <p class="text-slate-500 text-xs">Verify de-identified usage</p>
                            </div>
                        </div>

                        <!-- Button -->
                        <button id="ackBtn" onclick="acceptDisclaimer()" disabled
                            class="w-full py-4 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold tracking-wide shadow-lg shadow-blue-900/40 hover:shadow-blue-600/20 disabled:opacity-50 disabled:cursor-not-allowed transition-all transform active:scale-[0.98] opacity-50 cursor-not-allowed">
                            Enter Portal
                        </button>

                        <div class="flex justify-center">
                            <label class="flex items-center gap-2 cursor-pointer group p-2">
                                <input id="dontShowAgain" type="checkbox"
                                    class="rounded border-slate-700 bg-slate-800 text-blue-500 focus:ring-offset-0 focus:ring-transparent" />
                                <span
                                    class="text-xs text-slate-500 group-hover:text-slate-400 transition-colors">Remember
                                    this device</span>
                            </label>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Script removed: Logic now handled by js/main.js -> initDisclaimer() -->

    <!-- =================================================================== -->
    <!-- SIDEBAR -->
    <!-- =================================================================== -->
    <aside id="main-sidebar"
        class="w-64 bg-gemini-800 flex-col border-r border-white/5 hidden md:flex transition-all duration-300 z-40 fixed md:relative h-full">
        <!-- Branding Area -->
        <div class="p-6 pb-2 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div
                    class="w-8 h-8 rounded-lg bg-gradient-to-tr from-cyan-500 to-blue-600 flex items-center justify-center shadow-lg shadow-cyan-500/20">
                    <span class="material-symbols-outlined text-white text-[20px]">psychology_alt</span>
                </div>
                <div class="flex flex-col">
                    <span class="font-bold text-slate-100 tracking-tight">MedCon Portal</span>
                    <span class="text-[10px] text-slate-500 uppercase tracking-wider font-medium">MTF Provider
                        Portal</span>
                </div>
            </div>
            <!-- Mobile Close Button -->
            <button onclick="toggleSidebar()" class="md:hidden text-slate-400 hover:text-white">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>

        <!-- Scrollable Nav -->
        <div class="flex-1 overflow-y-auto custom-scroll px-3 py-2">

            <div class="text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2 px-3">Main Menu</div>
            <nav class="space-y-1 mb-8">
                <button onclick="switchView('dashboard')" id="nav-dashboard"
                    class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-white bg-blue-600/10 border border-blue-600/20 transition-all group text-left">
                    <span class="material-symbols-outlined text-[20px] text-blue-400">dashboard</span>
                    <span class="text-sm font-medium">Dashboard</span>
                </button>

                <button onclick="switchView('consults')" id="nav-consults"
                    class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-400 hover:bg-white/5 hover:text-white transition-all group text-left">
                    <span
                        class="material-symbols-outlined text-[20px] text-slate-500 group-hover:text-teal-400">clinical_notes</span>
                    <span class="text-sm font-medium">Consult Generator</span>
                </button>

                <button onclick="switchView('journal')" id="nav-journal"
                    class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-slate-400 hover:bg-white/5 hover:text-white transition-all group text-left">
                    <span
                        class="material-symbols-outlined text-[20px] text-slate-500 group-hover:text-amber-400">menu_book</span>
                    <span class="text-sm font-medium">Journal Clubs</span>
                </button>
            </nav>

            <!-- Quick References -->
            <div class="text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2 px-3">Quick Reference</div>
            <nav class="space-y-1 mb-6">
                <button
                    onclick="window.open('https://www.express-scripts.com/frontend/open-enrollment/tricare/fst/#/', '_blank')"
                    class="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 transition-colors group text-left">
                    <span
                        class="material-symbols-outlined text-[18px] text-slate-500 group-hover:text-slate-300">medication</span>
                    <span class="text-sm truncate">Formulary (DOD)</span>
                </button>

                <button onclick="window.open('https://www.mdcalc.com/', '_blank')"
                    class="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 transition-colors group text-left">
                    <span
                        class="material-symbols-outlined text-[18px] text-slate-500 group-hover:text-slate-300">calculate</span>
                    <span class="text-sm truncate">MedCalc</span>
                </button>

                <button onclick="window.open('https://www.openevidence.com/', '_blank')"
                    class="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 transition-colors group text-left">
                    <span
                        class="material-symbols-outlined text-[18px] text-slate-500 group-hover:text-slate-300">search</span>
                    <span class="text-sm truncate">OpenEvidence</span>
                </button>

                <button onclick="window.open('https://www.pubmed.ai/search/', '_blank')"
                    class="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 transition-colors group text-left">
                    <span
                        class="material-symbols-outlined text-[18px] text-slate-500 group-hover:text-slate-300">science</span>
                    <span class="text-sm truncate">PubMed AI</span>
                </button>

                <button onclick="window.open('https://chat.genai.army.mil/login?code=CDAO-NORTHCOM/', '_blank')"
                    class="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 transition-colors group text-left">
                    <span
                        class="material-symbols-outlined text-[18px] text-slate-500 group-hover:text-slate-300">military_tech</span>
                    <span class="text-sm truncate">Ask Sage</span>
                </button>
            </nav>
            <!-- Military (CAC Required) -->
            <div
                class="text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2 px-3 border-t border-white/5 pt-4">
                Military (CAC Required)</div>
            <nav class="space-y-1">
                <button onclick="window.open('https://avhe.health.mil', '_blank')"
                    class="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 transition-colors group text-left">
                    <span
                        class="material-symbols-outlined text-[18px] text-slate-500 group-hover:text-slate-300">dns</span>
                    <span class="text-sm truncate">Genesis (EMR)</span>
                </button>

                <button onclick="window.open('https://www.mods.army.mil', '_blank')"
                    class="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 transition-colors group text-left">
                    <span
                        class="material-symbols-outlined text-[18px] text-slate-500 group-hover:text-slate-300">admin_panel_settings</span>
                    <span class="text-sm truncate">MODS</span>
                </button>

                <button onclick="window.open('https://client.wvd.azure.us/arm/webclient/index.html', '_blank')"
                    class="w-full flex items-center gap-3 px-3 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/5 transition-colors group text-left">
                    <span
                        class="material-symbols-outlined text-[18px] text-slate-500 group-hover:text-slate-300">monitor_heart</span>
                    <span class="text-sm truncate">Army Remote Dash</span>
                </button>
            </nav>
        </div>
    </aside>

    <!-- Overlay for mobile sidebar -->
    <div id="sidebar-overlay" onclick="toggleSidebar()"
        class="fixed inset-0 bg-black/50 z-30 hidden md:hidden glass-search"></div>

    <!-- =================================================================== -->
    <!-- ACTIVE CONSULT SPA VIEW (Replaces Iframes) -->
    <!-- =================================================================== -->
    <div id="view-active-consult" class="hidden h-full overflow-y-auto bg-gemini-900 pb-20">
        <!-- Content injected by js/consult.js -->
    </div>
    <main class="flex-1 flex flex-col relative h-full bg-gemini-900">

        <!-- Top Bar (Header) -->
        <header
            class="h-16 flex-shrink-0 flex items-center justify-between px-6 border-b border-white/5 bg-gemini-900/95 backdrop-blur-sm z-30">
            <!-- Left: Page Title -->
            <div class="flex items-center gap-4">
                <!-- Added onclick to toggle Sidebar -->
                <button onclick="toggleSidebar()" class="md:hidden text-slate-400 hover:text-white">
                    <span class="material-symbols-outlined">menu</span>
                </button>
                <h1 id="page-title" class="text-xl font-bold text-slate-100">
                    Dashboard
                </h1>
            </div>

            <!-- Right: Search & External Link Action -->
            <div class="flex items-center gap-4">
                <!-- Generic Search (Now Active) -->
                <div class="relative w-64 hidden sm:block">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <span class="material-symbols-outlined text-slate-500 text-[18px]">search</span>
                    </div>
                    <input type="text" id="top-search-input" oninput="handleGlobalSearch(this.value)"
                        class="glass-search border border-slate-700 text-slate-200 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2 placeholder-slate-500 transition-all focus:bg-slate-800"
                        placeholder="Search protocols...">
                </div>

                <!-- External Link Button -->
                <div id="frame-controls" class="hidden flex items-center gap-2">
                    <button onclick="switchView('dashboard')"
                        class="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 hover:text-white transition-colors text-xs font-medium">
                        <span class="material-symbols-outlined text-[14px]">close</span>
                        <span>Close View</span>
                    </button>
                    <a id="external-link-btn" href="#" target="_blank"
                        class="flex items-center gap-2 px-3 py-1.5 rounded-lg bg-blue-600/10 text-blue-400 hover:bg-blue-600 hover:text-white transition-colors text-xs font-medium border border-blue-600/20">
                        <span>Open in New Tab</span>
                        <span class="material-symbols-outlined text-[14px]">open_in_new</span>
                    </a>
                </div>
            </div>
        </header>

        <!-- Content Views Container -->
        <div class="flex-1 overflow-hidden relative">

            <!-- VIEW 1: DASHBOARD -->
            <div id="view-dashboard" class="absolute inset-0 flex flex-col transition-opacity duration-300">
                <div class="flex-1 overflow-y-auto custom-scroll p-6 pb-32">
                    <div class="max-w-6xl mx-auto w-full animate-fade-in space-y-8">

                        <!-- 1. Hero / Chat Section -->
                        <div class="relative rounded-3xl overflow-hidden p-8 border border-white/5 shadow-2xl">
                            <!-- Background Gradient -->
                            <div
                                class="absolute inset-0 bg-gradient-to-br from-blue-900/40 via-gemini-800 to-gemini-900 z-0">
                            </div>
                            <div
                                class="absolute top-0 right-0 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl -mr-20 -mt-20 pointer-events-none">
                            </div>

                            <div class="relative z-10">
                                <h2 class="text-3xl font-bold text-white mb-2">What's on your mind, Doc? </h2>
                                <p class="text-slate-400 mb-8 max-w-2xl">

                                </p>

                                <!-- Chat Input -->
                                <div
                                    class="bg-gemini-800/80 backdrop-blur-md border border-slate-600/50 rounded-2xl shadow-lg flex flex-col relative focus-within:ring-2 focus-within:ring-blue-500/30 transition-all max-w-3xl">
                                    <textarea id="chatInput"
                                        placeholder="Clinical query (e.g., 'Latest STEMI guidelines')..."
                                        class="w-full bg-transparent text-slate-200 placeholder-slate-500 p-4 pl-5 min-h-[60px] max-h-48 resize-none focus:outline-none rounded-2xl"
                                        rows="1"
                                        oninput="this.style.height = ''; this.style.height = this.scrollHeight + 'px'"></textarea>

                                    <div class="flex items-center justify-end px-3 pb-3 relative">
                                        <!-- New Question Button (Hidden by default) -->
                                        <button id="newQuestionBtn" onclick="resetConsult()"
                                            class="hidden absolute left-3 flex items-center gap-1.5 px-3 py-1.5 bg-slate-700/50 hover:bg-slate-600 text-slate-300 hover:text-white text-xs font-medium rounded-lg border border-slate-600 transition-all">
                                            <span class="material-symbols-outlined text-[14px]">refresh</span>
                                            New Question
                                        </button>

                                        <button id="askBtn" onclick="askDrHoltkamp()"
                                            class="px-4 py-1.5 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-500 transition-all shadow-lg shadow-blue-900/20 disabled:opacity-50 disabled:cursor-not-allowed">
                                            Ask Dr. H
                                        </button>
                                    </div>
                                </div>
                                <p class="text-xs text-slate-500 mt-3 ml-1">
                                    Strictly evidence-based (guidelines/RCTs). No PHI.
                                </p>

                                <!-- DYNAMIC RESPONSE AREA -->
                                <div id="responseArea"
                                    class="hidden mt-6 bg-gemini-800/90 backdrop-blur-sm p-6 rounded-2xl border border-blue-500/30 shadow-2xl animate-fade-in relative overflow-hidden">
                                    <!-- Content injected by JS -->
                                </div>
                            </div>
                        </div>

                        <!-- 2. Fast Links -->
                        <div>
                            <h3 class="text-lg font-bold text-slate-300 mb-4 px-1">Fast Links</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-5">
                                <!-- Card 1: ADTMC -->
                                <!-- Card 1: ADTMC -->
                                <div onclick="openFrame('ADTMC.html', 'ADTMC')"
                                    class="block group cursor-pointer h-full">
                                    <div
                                        class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-green-500/50 h-full">
                                        <div
                                            class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                            <span
                                                class="material-symbols-outlined text-9xl text-green-500">medical_services</span>
                                        </div>
                                        <div class="relative z-10 flex flex-col h-full">
                                            <div
                                                class="w-12 h-12 rounded-full bg-green-900/30 flex items-center justify-center mb-4">
                                                <span
                                                    class="material-symbols-outlined text-2xl text-green-400">medical_services</span>
                                            </div>
                                            <h4 class="text-lg font-bold text-white mb-2">ADTMC</h4>
                                            <p class="text-slate-400 text-sm mb-4 flex-grow">Medic sick call services.
                                            </p>
                                            <span
                                                class="text-xs font-bold text-green-400 uppercase tracking-wider">Start
                                                Consult</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card 2: ADTMC+ -->
                                <div onclick="openFrame('ADTMCplus.html', 'ADTMC+')"
                                    class="block group cursor-pointer h-full">
                                    <div
                                        class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-indigo-500/50 h-full">
                                        <div
                                            class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                            <span
                                                class="material-symbols-outlined text-9xl text-indigo-500">medical_services</span>
                                        </div>
                                        <div class="relative z-10 flex flex-col h-full">
                                            <div
                                                class="w-12 h-12 rounded-full bg-indigo-900/30 flex items-center justify-center mb-4">
                                                <span
                                                    class="material-symbols-outlined text-2xl text-indigo-400">medical_services</span>
                                            </div>
                                            <h4 class="text-lg font-bold text-white mb-2">ADTMC+</h4>
                                            <p class="text-slate-400 text-sm mb-4 flex-grow">Sick call services for
                                                providers. Generate notes fast.</p>
                                            <span
                                                class="text-xs font-bold text-indigo-400 uppercase tracking-wider">Start
                                                Consult</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card 3: General Journal Club -->
                                <div onclick="openFrame('journalclub.html', 'General Journal Club')"
                                    class="block group cursor-pointer h-full">
                                    <div
                                        class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-red-500/50 h-full">
                                        <div
                                            class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                            <span
                                                class="material-symbols-outlined text-9xl text-red-500">menu_book</span>
                                        </div>
                                        <div class="relative z-10 flex flex-col h-full">
                                            <div
                                                class="w-12 h-12 rounded-full bg-red-900/30 flex items-center justify-center mb-4">
                                                <span
                                                    class="material-symbols-outlined text-2xl text-red-400">menu_book</span>
                                            </div>
                                            <h4 class="text-lg font-bold text-white mb-2">General Journal Club</h4>
                                            <p class="text-slate-400 text-sm mb-4 flex-grow">Evidence summaries and
                                                audio breakdowns.</p>
                                            <span class="text-xs font-bold text-red-400 uppercase tracking-wider">Read
                                                Journal</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Recent Activity Widget -->
                            <div class="mt-8 pt-8 border-t border-slate-700/50">
                                <div class="flex items-center justify-between mb-4 px-1">
                                    <h3 class="text-lg font-bold text-slate-300">Recent Consults</h3>
                                    <button
                                        onclick="localStorage.removeItem('consultHistory'); window.renderRecentActivity()"
                                        class="text-xs text-slate-500 hover:text-red-400 transition">Clear
                                        History</button>
                                </div>
                                <div id="recent-activity-list"
                                    class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Populated by JS -->
                                    <p class="text-slate-500 text-sm col-span-full italic">No recent consults found.</p>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- VIEW 2: CONSULTS (GRID) -->
            <div id="view-consults" class="absolute inset-0 overflow-y-auto custom-scroll p-6 hidden">
                <div class="max-w-7xl mx-auto">
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 pb-20">

                        <div class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-green-500/50 cursor-pointer"
                            onclick="openFrame('ADTMC.html', 'ADTMC')">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                <span class="material-symbols-outlined text-9xl text-green-500">medical_services</span>
                            </div>
                            <div class="relative z-10">
                                <div
                                    class="w-14 h-14 rounded-full bg-green-900/30 flex items-center justify-center mb-4">
                                    <span
                                        class="material-symbols-outlined text-3xl text-green-400">medical_services</span>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-2">ADTMC</h3>
                                <p class="text-slate-400 text-sm mb-4">Medic sick call services.<br><strong
                                        class="text-green-400 text-xs">Note Generation</strong></p>
                                <span class="text-xs font-bold text-green-400 uppercase tracking-wider">Start
                                    Consult</span>
                            </div>
                        </div>

                        <div class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-indigo-500/50 cursor-pointer"
                            onclick="openFrame('ADTMCplus.html', 'ADTMC+')">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                <span class="material-symbols-outlined text-9xl text-indigo-500">medical_services</span>
                            </div>
                            <div class="relative z-10">
                                <div
                                    class="w-14 h-14 rounded-full bg-indigo-900/30 flex items-center justify-center mb-4">
                                    <span
                                        class="material-symbols-outlined text-3xl text-indigo-400">medical_services</span>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-2">ADTMC+</h3>
                                <p class="text-slate-400 text-sm mb-4">Sick call for providers.<br><strong
                                        class="text-indigo-400 text-xs">Note Generation</strong></p>
                                <span class="text-xs font-bold text-indigo-400 uppercase tracking-wider">Start
                                    Consult</span>
                            </div>
                        </div>

                        <div class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-indigo-500/50 cursor-pointer"
                            onclick="startConsult('im')">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                <span class="material-symbols-outlined text-9xl text-indigo-500">stethoscope</span>
                            </div>
                            <div class="relative z-10">
                                <div
                                    class="w-14 h-14 rounded-full bg-indigo-900/30 flex items-center justify-center mb-4">
                                    <span class="material-symbols-outlined text-3xl text-indigo-400">stethoscope</span>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-2">Internal Medicine</h3>
                                <p class="text-slate-400 text-sm mb-4">Complex multisystem disease management and
                                    hospitalist logic.</p>
                                <span class="text-xs font-bold text-indigo-400 uppercase tracking-wider">Start
                                    Consult</span>
                            </div>
                        </div>

                        <div class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-purple-500/50 cursor-pointer"
                            onclick="openFrame('ICU.html', 'ICU')">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                <span class="material-symbols-outlined text-9xl text-purple-500">emergency</span>
                            </div>
                            <div class="relative z-10">
                                <div
                                    class="w-14 h-14 rounded-full bg-purple-900/30 flex items-center justify-center mb-4">
                                    <span class="material-symbols-outlined text-3xl text-purple-400">emergency</span>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-2">ICU</h3>
                                <p class="text-slate-400 text-sm mb-4">Critical Care consults.<br><strong
                                        class="text-purple-400 text-xs">Note Generation</strong></p>
                                <span class="text-xs font-bold text-purple-400 uppercase tracking-wider">Start
                                    Consult</span>
                            </div>
                        </div>

                        <div class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-red-500/50 cursor-pointer"
                            onclick="startConsult('cardiology')">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                <span class="material-symbols-outlined text-9xl text-red-500">heart_broken</span>
                            </div>
                            <div class="relative z-10">
                                <div class="w-14 h-14 rounded-full bg-red-900/30 flex items-center justify-center mb-4">
                                    <span class="material-symbols-outlined text-3xl text-red-400">ecg_heart</span>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-2">Cardiology</h3>
                                <p class="text-slate-400 text-sm mb-4">ECG interpretation, arrhythmia management, and
                                    ACS
                                    protocols.</p>
                                <span class="text-xs font-bold text-red-400 uppercase tracking-wider">Start
                                    Consult</span>
                            </div>
                        </div>

                        <div class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-yellow-500/50 cursor-pointer"
                            onclick="openFrame('neurology.html', 'Neurology')">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                <span class="material-symbols-outlined text-9xl text-yellow-500">psychology</span>
                            </div>
                            <div class="relative z-10">
                                <div
                                    class="w-14 h-14 rounded-full bg-yellow-900/30 flex items-center justify-center mb-4">
                                    <span class="material-symbols-outlined text-3xl text-yellow-400">psychology</span>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-2">Neurology</h3>
                                <p class="text-slate-400 text-sm mb-4">Brain + CNS consults.<br><strong
                                        class="text-yellow-400 text-xs">Note Generation</strong></p>
                                <span class="text-xs font-bold text-yellow-400 uppercase tracking-wider">Start
                                    Consult</span>
                            </div>
                        </div>

                        <div class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-pink-500/50 cursor-pointer"
                            onclick="openFrame('pediatrics.html', 'Pediatrics')">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                <span class="material-symbols-outlined text-9xl text-pink-500">child_care</span>
                            </div>
                            <div class="relative z-10">
                                <div
                                    class="w-14 h-14 rounded-full bg-pink-900/30 flex items-center justify-center mb-4">
                                    <span class="material-symbols-outlined text-3xl text-pink-400">child_care</span>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-2">Pediatrics</h3>
                                <p class="text-slate-400 text-sm mb-4">Infants + children.<br><strong
                                        class="text-pink-400 text-xs">Note Generation</strong></p>
                                <span class="text-xs font-bold text-pink-400 uppercase tracking-wider">Start
                                    Consult</span>
                            </div>
                        </div>

                        <div class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-teal-500/50 cursor-pointer"
                            onclick="openFrame('psychiatry.html', 'Psychiatry')">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                <span class="material-symbols-outlined text-9xl text-teal-500">psychology_alt</span>
                            </div>
                            <div class="relative z-10">
                                <div
                                    class="w-14 h-14 rounded-full bg-teal-900/30 flex items-center justify-center mb-4">
                                    <span class="material-symbols-outlined text-3xl text-teal-400">psychology_alt</span>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-2">Psychiatry</h3>
                                <p class="text-slate-400 text-sm mb-4">Mental health consults.<br><strong
                                        class="text-teal-400 text-xs">Note Generation</strong></p>
                                <span class="text-xs font-bold text-teal-400 uppercase tracking-wider">Start
                                    Consult</span>
                            </div>
                        </div>

                        <div class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-orange-500/50 cursor-pointer"
                            onclick="openFrame('orthopedic_surgery.html', 'Orthopedics')">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                <span
                                    class="material-symbols-outlined text-9xl text-orange-500">accessibility_new</span>
                            </div>
                            <div class="relative z-10">
                                <div
                                    class="w-14 h-14 rounded-full bg-orange-900/30 flex items-center justify-center mb-4">
                                    <span
                                        class="material-symbols-outlined text-3xl text-orange-400">accessibility_new</span>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-2">Orthopedics</h3>
                                <p class="text-slate-400 text-sm mb-4">Bone + joint consults.<br><strong
                                        class="text-orange-400 text-xs">Note Generation</strong></p>
                                <span class="text-xs font-bold text-orange-400 uppercase tracking-wider">Start
                                    Consult</span>
                            </div>
                        </div>

                        <div class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-cyan-500/50 cursor-pointer"
                            onclick="openFrame('rheumatology.html', 'Rheumatology')">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                <span class="material-symbols-outlined text-9xl text-cyan-500">science</span>
                            </div>
                            <div class="relative z-10">
                                <div
                                    class="w-14 h-14 rounded-full bg-cyan-900/30 flex items-center justify-center mb-4">
                                    <span class="material-symbols-outlined text-3xl text-cyan-400">science</span>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-2">Rheumatology</h3>
                                <p class="text-slate-400 text-sm mb-4">Autoimmune consults.<br><strong
                                        class="text-cyan-400 text-xs">Note Generation</strong></p>
                                <span class="text-xs font-bold text-cyan-400 uppercase tracking-wider">Start
                                    Consult</span>
                            </div>
                        </div>

                        <!-- Blocked Cards -->
                        <div class="card-blocked rounded-2xl p-6 flex flex-col">
                            <h3 class="text-xl font-bold text-slate-600 mb-2">Endocrinology</h3>
                            <p class="text-slate-700 mb-6 flex-grow text-sm">Hormone/metabolism.</p>
                            <span
                                class="mt-auto w-full bg-slate-800 text-slate-500 font-medium py-2.5 px-4 rounded-xl text-center text-sm">Coming
                                Soon</span>
                        </div>
                        <div class="card-blocked rounded-2xl p-6 flex flex-col">
                            <h3 class="text-xl font-bold text-slate-600 mb-2">Gastroenterology</h3>
                            <p class="text-slate-700 mb-6 flex-grow text-sm">Digestive consults.</p>
                            <span
                                class="mt-auto w-full bg-slate-800 text-slate-500 font-medium py-2.5 px-4 rounded-xl text-center text-sm">Coming
                                Soon</span>
                        </div>

                    </div>
                </div>
            </div>

            <!-- VIEW 3: JOURNAL CLUB (GRID) -->
            <div id="view-journal" class="absolute inset-0 overflow-y-auto custom-scroll p-6 hidden">
                <div class="max-w-7xl mx-auto">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

                        <!-- Main Journal Club -->
                        <div class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-red-500/50 cursor-pointer"
                            onclick="openFrame('journalclub.html', 'General Journal Club')">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                <span class="material-symbols-outlined text-9xl text-red-500">menu_book</span>
                            </div>
                            <div class="relative z-10">
                                <div class="w-14 h-14 rounded-full bg-red-900/30 flex items-center justify-center mb-4">
                                    <span class="material-symbols-outlined text-3xl text-red-400">menu_book</span>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-2">General Journal Club</h3>
                                <p class="text-slate-400 text-sm mb-4">Evidence summaries, audio breakdowns, and
                                    landmark
                                    trials across all specialties.</p>
                                <span class="text-xs font-bold text-red-400 uppercase tracking-wider">Open Journal
                                    Club</span>
                            </div>
                        </div>

                        <!-- Military Medicine -->
                        <div class="card bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden group hover:border-emerald-500/50 cursor-pointer"
                            onclick="openFrame('journalclub_mil.html', 'Military Medicine')">
                            <div
                                class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity duration-300">
                                <span
                                    class="material-symbols-outlined text-9xl text-emerald-500">medical_services</span>
                            </div>
                            <div class="relative z-10">
                                <div
                                    class="w-14 h-14 rounded-full bg-emerald-900/30 flex items-center justify-center mb-4">
                                    <span
                                        class="material-symbols-outlined text-3xl text-emerald-400">medical_services</span>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-2">Military Medicine</h3>
                                <p class="text-slate-400 text-sm mb-4">Operational medicine updates, TCCC guidelines,
                                    and
                                    deployment health resources.</p>
                                <span class="text-xs font-bold text-emerald-400 uppercase tracking-wider">Open Military
                                    Journal</span>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- VIEW 4: SEARCH RESULTS (NEW) -->
            <div id="view-search-results" class="absolute inset-0 overflow-y-auto custom-scroll p-6 hidden">
                <div class="max-w-6xl mx-auto">
                    <h2 class="text-2xl font-bold text-white mb-6">Search Results</h2>
                    <div id="search-results-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Dynamic Search Results Injected Here -->
                    </div>
                </div>
            </div>

            <!-- VIEW 5: IFRAME VIEWER -->
            <div id="view-iframe" class="absolute inset-0 flex flex-col hidden bg-white">
                <div class="w-full h-1 bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500"></div>
                <!-- Added error handling fallback in logic -->
                <iframe id="main-frame" src="" class="w-full h-full border-0"
                    sandbox="allow-same-origin allow-scripts allow-forms allow-popups"></iframe>
            </div>

        </div>
    </main>

    <script type="module" src="js/main.js"></script>

</body>

</html>